---
title: "Перенаправление запросов к контенту"
description: "В данном разделе описана опция CDN-ресурса, позволяющая изменять пути запросов от CDN-ресурса к источнику с помощью правил Rewrite."
---

# Перенаправление запросов

Вы можете [настроить перенаправление](../operations/resources/setup-http-rewrite.md) запросов от [CDN-ресурса](./resource.md) к источнику, изменив [URI](https://ru.wikipedia.org/wiki/URI) запроса с помощью [правила](#rewrite-rule) `Rewrite`.

Например, с помощью этой опции вы можете перенастроить пути запросов к контенту, если на [источнике](./origins.md) оказалась изменена структура файлов и папок. Также перенаправление можно использовать, если при переезде ресурса на новый адрес вы хотите сохранить ранжирование вашего контента в поисковых системах.

Включить перенаправление запросов для CDN-ресурса вы можете с помощью [консоли управления]({{ link-console-main }}), [CLI](../../cli/cli-ref/managed-services/cdn/resource/update.md) или [API](../api-ref/Resource/update.md).

Чтобы настроить перенаправление запросов, необходимо задать [правило Rewrite](#rewrite-rule) и указать [флаг](#flag).

Подробности о перенаправлении запросов см. в документации CDN-провайдера EdgeЦентр:
* [Rewrite. Настроить перенаправление запросов](https://edgecenter.ru/knowledge-base/cdn/cdn-rewrite?c=17)
* [Документация API](https://apidocs.edgecenter.ru/cdn#tag/Resources/operation/change_cdn_resource)

## Правило Rewrite {#rewrite-rule}

Правило Rewrite должно содержать две разделенные пробелом директивы:

* **Исходный путь** — часть URI, которую требуется заменить. Задается в виде [регулярного выражения](https://ru.wikipedia.org/wiki/Регулярные_выражения).

    Фрагменты регулярного выражения могут быть обособлены скобками — в этом случае соответствующие таким фрагментам части URI будут доступны в _измененном пути_ в значениях переменных `$1`, `$2`, ... `$9`, где номер переменной соответствует порядковому номеру обособленного фрагмента регулярного выражения в _исходном пути_.

* **Измененный путь** — часть URI, которая должна заменить исходный путь, соответствующий заданному регулярному выражению.

    В измененном пути можно использовать переменные, содержащие фрагменты исходного пути, которые были обособлены в нем с помощью скобок: `$1`, `$2`, ... `$9`.

**Пример правила Rewrite:**

> `/(videos)/(events)/(\d{4}-\d{2}-\d{2})/(.*) /$2/$1/$3-$4`
>
> Данное правило изменит URI запроса следующим образом:
>
> Исходный URI: `https://example.com/videos/events/2024-01-01/new-year.avi`
> Конечный URI: `https://example.com/events/videos/2024-01-01-new-year.avi`

## Флаг {#flag}

Флаги позволяют прекратить дальнейшую обработку директив `Rewrite` или вернуть пользователю `redirect`. Для правил `Rewrite` доступны следующие флаги:

{% include [rewrite-flag-list](../../_includes/cdn/rewrite-flag-list.md) %}

#### См. также {#see-also}

* [Инструкция по включению перенаправления запросов](../operations/resources/setup-http-rewrite.md)