# Расширение модели распознавания речи

{{ speechkit-name }} предоставляет несколько способов, которыми можно повысить качество распознавания речи:

* [автотюнинг](#autotuning);
* [дообучение модели](#advanced-training);
* [использование аудио для улучшения качества](#audio).

## Автотюнинг {#autotuning}

По умолчанию {{ speechkit-name }} не сохраняет переданные пользователем данные. Однако самый эффективный способ улучшить модель распознавания речи — это обучить ее на реальных пользовательских данных.

Чтобы повысить качество распознавания, используйте _автотюнинг_ модели. Он позволит сохранять переданные в запросах данные и применять их для дальнейшего обучения. Автотюнинг повышает качество распознавания в процессе работы модели без дополнительных действий с вашей стороны.

Автотюнинг подходит, когда выполняются следующие условия:

* В уже настроенном сценарии, который используется для решения рабочих задач, не распознается часть лексики.
* Лексика для автотюнинга должна быть такой, чтобы ее можно было легко воспринять на слух и записать транскрипцией. Например, названия лекарств не подойдут, так как эта лексика из узкой предметной области. Если нужно распознавать доменно-специфичные термины, используйте [дообучение модели](#advanced-training).

Чтобы передать данные для автотюнинга, включите логирование. Для этого в запросах API укажите заголовок `x-data-logging-enabled: true`. Пример запроса с включенным логированием см. в разделе [{#T}](../concepts/support-headers.md).

Ограничения и требования:

{% include [autotuning-requirements](../../_includes/speechkit/autotuning-requirements.md) %}

## Дообучение модели {#advanced-training}

Основная модель распознавания речи предназначена для работы с общей лексикой, однако ее может быть недостаточно для распознавания специфичной лексики. С помощью [дообучения](../../glossary/ml-models.md#fine-tuning) модель можно научить распознавать доменно-специфичные термины из разных областей:

* медицина — диагнозы, биологические термины, названия лекарств;
* бизнес — названия компаний;
* торговля — номенклатура товаров (ювелирные изделия, электротехника и т. п.);
* финансы — банковские термины и названия банковских продуктов.

Для дообучения необходимы текстовые шаблоны и глоссарии.

### Текстовый шаблон {#templates}

_Текстовый шаблон_ содержит однородные фразы с переменными, на основе которых модель синтезирует высказывания. На место переменных подставляются термины из глоссария.

Чтобы улучшить общее качество распознавания, шаблоны можно использовать вместе с [автотюнингом](#autotuning). Они подойдут, даже когда нужна специфичная лексика, например названия лекарств.

### Глоссарий {#glossary}

_Глоссарий_ — полный список терминов, которые используются вместо переменных в шаблонах. Глоссарий содержит слова, которые есть в аудиозаписях для тестирования, а также другую лексику.

Глоссарий должен быть предоставлен отдельным файлом. Он создается под каждую переменную из шаблона. Эта переменная используется в качестве названия каждого файла с глоссарием. Каждый термин в файле размещается на отдельной строке.

Например, файлы-глоссарии `first-name.tsv`, `middle-name.tsv` и `last-name.tsv` для дообучения модели колл-центра могут содержать имена, отчества и фамилии клиентов.

| first-name.tsv | middle-name.tsv | last-name.tsv |
|---|---|---|
|  Никита<br>Кирилл<br>Павел<br>... <br> |  Александрович<br>Петрович<br>Казимирович<br>... <br> | Романов<br>Алексеев<br>Кукушкин<br>... <br> |

Если фразы-шаблоны предполагают, что термины из глоссария могут склоняться, для каждой формы нужно создать отдельный файл-глоссарий. Например, файлы с именами в творительном падеже будут содержать записи:

| first-name-ablative.tsv | middle-name-ablative.tsv | last-name-ablative.tsv |
|---|---|---|
|  Никитой<br>Кириллом<br>Павлом<br>... <br> |  Александровичем<br>Петровичем<br>Казимировичем<br>... <br> | Романовым<br>Алексеевым<br>Кукушкиным<br>... <br> |

Тогда файл с шаблонами `templates.tsv` может состоять из записей следующего вида:

```text
Добрый день, вы {first-name=first-names.tsv} {middle-name=middle-names.tsv} {last-name=last-names.tsv}?
Здравствуйте, я могу поговорить с {first-name=first-names-ablative.tsv} {middle-name=middle-names-ablative.tsv}?
```

### Ограничения и требования к текстовым шаблонам и глоссариям {#requirements}

Глоссарии и текстовые шаблоны должны быть представлены в файлах формата [TSV](https://ru.wikipedia.org/wiki/TSV) в нормализованном виде:

* Числительные — расшифрованы прописью.
* Латинские слова и символы — заменены на транскрипцию.
* Сокращения — полностью прописаны.
* Аббревиатуры на иностранном языке — расшифрованы полностью или заменены на транскрипцию.
* Аббревиатуры на русском языке — оставлены без изменений.

> ![No](../../_assets/common/no.svg) — Безвозмездно, т.е. даром, отдадим 2 кг картошки, модель спирали ДНК и журналы Cloud of Science за 2020 г.
> 
> ![Yes](../../_assets/common/yes.svg) — Безвозмездно, то есть даром, отдадим два килограмма картошки, модель спирали ДНК и журналы Клауд оф сайенс за две тысячи двадцатый год.

Требования к текстовым шаблонам и глоссариям:

* Длина шаблона вместе с переменными не должна превышать 200 символов.
* Поддерживается только русский язык.
* Дообучение эффективнее, если на каждый термин из глоссария приходится не менее 100 фраз.

Дообучение занимает около двух месяцев с момента, как вы [передали технической поддержке архив с данными](upload-data-for-training.md).


## Использование аудио для улучшения качества {#audio}

Вы можете передать команде {{ speechkit-name }} аудиофайл для улучшения качества распознавания речи. Метод аналогичен [автотюнингу](#autotuning), но вместо переданных в API-запросах данных используется подготовленное вами аудио. [Передайте его технической поддержке]({{ link-console-support }}) в виде ZIP-архива.

Ограничения для такого способа совпадают с ограничениями для автотюнинга:

{% include [autotuning-requirements](../../_includes/speechkit/autotuning-requirements.md) %}
