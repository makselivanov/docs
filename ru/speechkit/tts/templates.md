# Синтез речи по шаблонам

С помощью синтеза по шаблонам вы можете синтезировать речь по заранее заготовленным фразам (_шаблонам_), в которых изменяются отдельные ключевые части — _переменные_. Новая фраза будет синтезирована целиком, а не склеена из заранее записанного и синтезированного блоков. При этом интонации копируются из шаблона, а речь звучит естественно и неотличима от речи живого человека.

Синтез по шаблонам доступен только для голосов [{{ brand-voice-name }}](brand-voice/index.md).


{% note warning %}

Сервис {{ brand-voice-name }} предоставляется по запросу. Для доступа к технологии [заполните форму](#contact-form).

{% endnote %}



## Исходные данные для синтеза по шаблонам {#income-data}

Каждый запрос для синтеза по шаблонам должен содержать:

* аудиозапись шаблонной фразы;
* текстовый шаблон с разметкой переменных частей;
* значения переменных для синтеза новой фразы;
* временную метку начала и длительность каждой переменной части.

{% note warning %}

Длина нормализованного текста переменной части фразы может занимать не более 25% синтезируемой фразы. То же ограничение действует на длительность переменной части относительно длительности итоговой аудиозаписи.

{% endnote %}

> Например, желаемая фраза для синтеза `Давайте проверим бронирование. Ваш рейс состоится восьмого сентября в одиннадцать часов двадцать минут. Аэропорт вылета Домодедово, аэропорт прилета Пулково. Всё верно?`
> Аудиозапись шаблона содержит фразу `Давайте проверим бронирование. Ваш рейс состоится двадцать третьего марта в двадцать один час ноль ноль минут. Аэропорт вылета Домодедово, аэропорт прилета Пулково. Всё верно?`.
> Текстовый шаблон должен выглядеть так: `Давайте проверим бронирование. Ваш рейс состоится {date} в {time}. Аэропорт вылета Домодедово, аэропорт прилета Пулково. Всё верно?`
> Список переменных: `variable_name = '{date}', variable_value = 'восьмого сентября'`, `variable_name = '{time}', variable_value = 'одиннадцать часов двадцать минут`.

Подробнее о [примерах реализации синтеза по шаблонам](#templates-implementation).

### Требования к аудиозаписям шаблонов {#requirements-audio}

| Требование | Значение |
| --- | --- |
| Частота дискретизации | 48 кГц для {{ brand-voice-core-name }} и {{ brand-voice-premium-name }}</br>{{ tts-cc-quality }} или выше для {{ brand-voice-cc-name }} |
| Глубина аудио (audio bit depth) |  16 бит PCM |
| Количество каналов |  1 (моно) |
| Формат | [WAV](https://ru.wikipedia.org/wiki/WAV) |
| Минимальная длительность аудиозаписи шаблона | 1 секунда |

Аудиозаписи шаблонов не должны содержать посторонние шумы и эхо. Допускается минимальная обработка аудиозаписи. Длительность тишины в начале и в конце записи — не более 1 секунды.

### Рекомендации для записи аудио {#tips}

{% include notitle [tips](../../_includes/speechkit/audio-tips.md) %}

### Требования к синтезируемым текстам {#requirements-text}

Шаблон должен соответствовать желаемому скрипту.

В шаблоне должна быть одна или несколько переменных для замены. Длительность звучания переменной части должна соответствовать образцу в шаблоне. Если длительность звучания переменной части может сильно отличаться, рекомендуем записать несколько шаблонов с примерами разной длины. Нормализованный текст переменной части фразы должен занимать не больше 25% от длины шаблона. То же ограничение действует на длительность переменной части относительно длительности итоговой аудиозаписи.

> Например, если в шаблоне `Здравствуйте, меня зовут Ирина, я работаю в {company}.` длина переменной `company` может быть очень разной (`компании Облака`, `банке Надежность`, `региональном представительстве известной зарубежной компании`), запишите два шаблона — для коротких и длинных значений. В зависимости от подставляемого значения передавайте при синтезе один из них. Так синтезированная речь останется естественной.

Длинные реплики диктора необходимо разбить на самостоятельные предложения и разные шаблоны. Синтезируемая фраза не может превышать {{ tts-v3-time }} и {{ tts-v3-count }}.

{% include [text requirements](../../_includes/speechkit/tts-text-requirements.md) %}

{% note warning %}

Логическое ударение не должно падать на переменную часть фразы.

{% endnote %}

## Использование синтеза по шаблонам {#templates-implementation}

* API v3:

   * [{{ brand-voice-premium }} и {{ brand-voice-core }}](api/tts-templates.md).
   * [{{ brand-voice-cc-name }}](api/tts-templates-bvcc.md).

