1. [Подготовьте облако к работе](#before-you-begin).
1. [Создайте ВМ с платформой OpenCart](#create-vm).
1. [(опционально) Создайте кластер БД {{ MY }}](#create-mysql).
1. [Настройте OpenCart](#configure-opencart).

Если созданные ресурсы вам больше не нужны, [удалите их](#clear-out).


## Подготовьте облако к работе {#before-you-begin}

{% include [before-you-begin](../_tutorials_includes/before-you-begin.md) %}

### Необходимые платные ресурсы {#paid-resources}

{% include [opencart-paid-resources](../_tutorials_includes/opencart-paid-resources.md) %}

## Создайте ВМ с платформой OpenCart {#create-vm}

На загрузочном диске ВМ будет предустановлена платформа OpenCart и необходимые для ее работы компоненты, включая PHP и {{ MY }}.

Чтобы создать ВМ:

{% list tabs %}

- Консоль управления

  1. В [консоли управления]({{ link-console-main }}) выберите [каталог](../../resource-manager/concepts/resources-hierarchy.md#folder), в котором будет создана ВМ.
  1. В списке сервисов выберите **{{ compute-short-name }}**.
  1. На панели слева выберите ![image](../../_assets/console-icons/server.svg) **Виртуальные машины**.
  1. Нажмите кнопку **Создать виртуальную машину**.
  1. В блоке **Выбор образа/загрузочного диска**:

      * Перейдите на вкладку **Marketplace**.
      * Нажмите кнопку **Показать все продукты Marketplace**.
      * В списке публичных [образов](../../compute/concepts/image.md) выберите [OpenCart](/marketplace/products/yc/opencart-3). и нажмите кнопку **Использовать**.

  1. В блоке **Расположение** выберите [зону доступности](../../overview/concepts/geo-scope.md), в которой будет находиться ВМ.
  1. В блоке **Диски и файловые хранилища** настройте загрузочный [диск](../../compute/concepts/disk.md):

      * Выберите [тип диска](../../compute/concepts/disk.md#disks_types) `SSD`.
      * Задайте размер диска `13 ГБ`.

  1. В блоке **Вычислительные ресурсы** перейдите на вкладку **Своя конфигурация** и укажите следующую конфигурацию:

      * **Платформа** — `Intel Ice Lake`.
      * **Гарантированная доля vCPU** — `20%`.
      * **vCPU** — `2`.
      * **RAM** — `4 ГБ`.

  1. В блоке **Сетевые настройки**:

      * В поле **Подсеть** укажите идентификатор подсети в зоне доступности создаваемой ВМ или выберите [облачную сеть](../../vpc/concepts/network.md#network) из списка.

          * У каждой сети должна быть как минимум одна [подсеть](../../vpc/concepts/network.md#subnet). Если подсети нет, создайте ее, выбрав **Создать подсеть**.
          * Если сети нет, нажмите **Создать сеть** и создайте ее:

              * В открывшемся окне укажите имя сети и выберите каталог, в котором она будет создана.
              * (Опционально) Выберите опцию **Создать подсети**, чтобы автоматически создать подсети во всех зонах доступности.
              * Нажмите **Создать сеть**.

      * В поле **Публичный адрес** выберите `{{ ui-key.yacloud.component.compute.network-select.switch_auto }}`, чтобы назначить случайный IP-адрес из пула адресов {{ yandex-cloud }}, или выберите статический адрес из списка, если вы зарезервировали его заранее.

    1. В блоке **Доступ** выберите **Неизменяемый ключ** и укажите данные для доступа к ВМ:

        * В поле **Логин** введите предпочтительное имя пользователя, который будет создан на ВМ, например, `ubuntu`.
        * {% include [access-ssh-key](../../_includes/compute/create/access-ssh-key.md) %}

  1. В блоке **Общая информация** введите имя ВМ, например `opencart`. Требования к имени:

      {% include [name-format](../../_includes/name-format.md) %}

  1. Нажмите кнопку **Создать ВМ**.
  1. Получите [публичный IP-адрес](../../vpc/concepts/address.md#public-addresses) ВМ — он потребуется далее, чтобы [настроить OpenCart](#configure-opencart). Публичный IP-адрес можно узнать в консоли управления в поле **{{ ui-key.yacloud.compute.instance.overview.label_public-ipv4 }}** блока **{{ ui-key.yacloud.compute.instance.overview.section_network }}** на странице ВМ.

{% endlist %}

Если вы рассчитываете на существенную нагрузку на БД, или хотели бы использовать сервис управляемых СУБД, то [создайте кластер БД](#create-mysql) с помощью сервиса {{ mmy-name }}. Если нет — [настройте OpenCart](#configure-opencart).

## Создайте кластер БД {{ MY }} {#create-mysql}

Сервис {{ mmy-name }} берет на себя поддержку и обслуживание СУБД, в том числе мониторинг ее состояния и текущей активности, автоматическое создание резервных копий и легко настраиваемую отказоустойчивость.

Если необходимости в кластере нет, пропустите этот шаг и [настройте OpenCart](#configure-opencart).

Чтобы создать кластер БД:

{% list tabs %}

- Консоль управления

  1. На странице каталога в [консоли управления]({{ link-console-main }}) нажмите кнопку **Создать ресурс** и выберите пункт **Кластер {{ MY }}**.
  1. Укажите имя кластера, например, `opencart`.
  1. В блоке **Класс хоста** выберите `s2.micro`. Данных характеристик хватит для работы системы без особых нагрузок.
  1. В блоке **База данных** укажите:
     * **Имя БД** — оставьте значение по умолчанию, `db1`.
     * **Имя пользователя** для подключения к БД — оставьте значение по умолчанию, `user1`.
     * **Пароль**, который OpenCart будет использовать для доступа к БД {{ MY }}.
  1. В блоке **Хосты**, при необходимости поменяйте **Зону доступности**, в которой должна находиться БД. Для этого нажмите значок ![pencil](../../_assets/console-icons/pencil.svg) справа от текущей выбранной зоны доступности и выберите из выпадающего списка нужную.

     {% note tip %}

     Рекомендуется выбрать ту же зону доступности, которую вы выбрали при создании ВМ. Это позволит уменьшить задержку (latency) между ВМ и БД.

     {% endnote %}

  1. (опционально) Если вы хотите обеспечить отказоустойчивость БД, добавьте дополнительные хосты в кластер: для этого нажмите **Добавить хост** и укажите, в какой зоне доступности он должен быть размещен.
  1. Остальные поля оставьте без изменений.
  1. Нажмите кнопку **Создать кластер**.

{% endlist %}

Создание кластера БД может занять несколько минут. После создания [настройте OpenCart](#configure-opencart).

## Настройте OpenCart {#configure-opencart}

{% include [opencart-configure](../_tutorials_includes/opencart-configure.md) %}

## Как удалить созданные ресурсы {#clear-out}

Чтобы перестать платить за созданные ресурсы:

1. [Удалите](../../compute/operations/vm-control/vm-delete.md) ВМ `opencart`.
1. Если вы использовали БД {{ MY }}, то [удалите кластер {{ mmy-name }}](../../managed-mysql/operations/cluster-delete.md) (в примере кластер БД создается с именем `opencart`).

Если вы зарезервировали статический публичный IP-адрес специально для этой ВМ:
1. Выберите сервис **{{ vpc-short-name }}** в вашем каталоге.
1. Перейдите на вкладку **IP-адреса**.
1. Найдите нужный IP-адрес, нажмите значок ![ellipsis](../../_assets/console-icons/ellipsis.svg) и выберите пункт **Удалить**.
