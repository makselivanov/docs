# Протокол {{ kraft-name }} в кластерах {{ mkf-name }}

_[{{ kraft-name }}](https://docs.confluent.io/platform/current/kafka-metadata/kraft.html)_ (сокращенно {{ kraft-short-name }}) — протокол согласования, который позволяет хранить метаданные и управлять ими внутри {{ KF }}. {{ kraft-short-name }} устраняет зависимость {{ KF }} от внешнего сервиса синхронизации метаданных {{ ZK }}.

{{ kraft-short-name }} поддержан в кластерах {{ mkf-name }} с версией {{ KF }} 3.6 и выше. [{{ ZK }} используется](index.md#zookeeper) только в более ранних версиях.

Причины замены {{ ZK }} на {{ kraft-short-name }}:

* {{ ZK }} устарел в версиях {{ KF }} 3.5 и выше;
* с версией {{ KF }} 4.0 поддержка {{ ZK }} прекратится.

## Топология кластера {{ mkf-name }} {#cluster-topology}

{% include [kraft-cluster-topology](../../_includes/mdb/mkf/kraft-cluster-topology.md) %}

## Преимущества и недостатки {{ kraft-name }} {#pros-and-cons}

Преимущества {{ kraft-short-name }} связаны с тем, что {{ KF }} больше не зависит от внешней системы {{ ZK }}:

* Не нужно доплачивать за хосты {{ ZK }}.
* Для информационной безопасности используется один механизм вместо нескольких.
* Управлять кластером с {{ kraft-short-name }} проще, так как в кластере нет хостов {{ ZK }}.
* Повышается отказоустойчивость кластера, в случае сбоя кластер восстанавливается почти мгновенно.
* Можно создавать бо́льшее количество партиций в кластере.

Подробнее см. на [сайте](https://developer.confluent.io/learn/kraft/#benefits-of-kafkas-new-quorum-controller) и в [документации](https://docs.confluent.io/platform/current/kafka-metadata/kraft.html) Confluent.

Недостатки {{ kraft-short-name }} объясняются [особенностями топологии кластеров](#cluster-topology):

* В комбинированном режиме контроллеры метаданных {{ kraft-short-name }} не изолированы от {{ KF }} настолько же хорошо, как хосты {{ ZK }}. Поэтому [{{ KF }} не рекомендует]({{ kf.docs }}#kraft_role) использовать {{ kraft-short-name }} в критически важных средах разработки. {{ kraft-short-name }} больше подходит для локальной разработки и тестирования.
* В кластере с {{ kraft-short-name }} нельзя гибко управлять количеством хостов, допускается ровно три хоста.
